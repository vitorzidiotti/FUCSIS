{% extends "base.html" %}

{% block title %}Editar Produto{% endblock %}

{% block content %}
    <div class="auth-container" style="margin-top: 2rem;">
        <h1>Editar Produto</h1>
        {# Prioriza dados do request.form se a página foi recarregada por erro, senão usa dados do produto #}
        <form method="POST" action="{{ url_for('produto.editar_produto', id_produto=produto.id_produto) }}">

            <label for="nome">Nome do Produto:</label>
            <input type="text" id="nome" name="nome" value="{{ request.form.get('nome', produto.nome) }}" required>

            <label for="marca">Marca:</label>
            <input type="text" id="marca" name="marca" value="{{ request.form.get('marca', produto.marca) }}" required>

            <label for="preco">Preço (R$):</label>
            <input type="number" id="preco" name="preco" step="0.01" min="0" value="{{ request.form.get('preco', produto.preco) }}" required>

            <label for="medida">Medida:</label>
            <select id="medida" name="medida" required>
                <option value="" disabled {% if not request.form.get('medida', produto.medida) %}selected{% endif %}>Selecione...</option>
                {% set medida_selecionada = request.form.get('medida', produto.medida) %}
                {% for unidade in unidades %}
                <option value="{{ unidade }}" {% if medida_selecionada == unidade %}selected{% endif %}>
                    {{ unidade|upper }}
                </option>
                {% endfor %}
            </select>

            <label for="validade">Validade:</label>
            <input type="date" id="validade" name="validade" value="{{ request.form.get('validade', produto.validade) }}" required min="{{ min_date }}"> {# Adicionado min="{{ min_date }}" #}

            <label for="lote">Lote:</label>
            <input type="text" id="lote" name="lote" value="{{ request.form.get('lote', produto.lote) }}" required>

            <button type="submit" class="btn btn-green" style="width: 100%; padding: 14px; margin-top: 1rem;">Salvar Alterações</button>
            <a href="{{ url_for('produto.gerenciar_produtos') }}" class="btn btn-yellow" style="width: 100%; padding: 14px;">Cancelar</a>
        </form>
    </div>
{% endblock %}